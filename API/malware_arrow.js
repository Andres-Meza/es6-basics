//API de datos de PaÃ­ses
//CALLBACK - Funcion Flecha

let XMLHttpRequest = require("xmlhttprequest").XMLHttpRequest;

let endpoint = 'https://urlhaus-api.abuse.ch/v1/urls/recent/';

const exito = (response) => {
  const elements = JSON.parse(response).urls;
  elements.forEach(element => {
    console.log(`Id: ${element.id}`);
    console.log(`URL Reference: ${element.urlhaus_reference}`);
    console.log(`Amenaza: ${element.threat}`);
    console.log("-----------------------------------")
  });
}

const fallo = (status) => {
  console.log(status)
}

const getData = (endpoint, exito, fallo) =>{
  let xhr = new XMLHttpRequest();
  xhr.open('GET', endpoint);
  xhr.send();
  xhr.onload = () => {
    if( xhr.status === 200 ){
      exito(xhr.responseText)
    }else{
      fallo(xhr.status)
    }
  }
}

getData(endpoint, exito, fallo)
